<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Театр историй</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;900&family=Playfair+Display:ital@1&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Шапка -->
    <header class="new-header">
        <div class="header-container">
            <h1 class="header-title">ТЕАТР ИСТОРИЙ</h1>
        </div>
    </header>

    <!-- Слайды -->
    <div class="slides-container" id="slidesContainer">
        <div class="slide-wrapper">
            <!-- Слайд 1 -->
            <div class="slide-item">
                <img src="Images/img1.png" alt="Слайд 1">
            </div>
            
            <!-- Чехов1.M4V (после 1 слайда) -->
            <div class="video-item">
                <video controls preload="metadata" playsinline muted>
                    <source src="Чехов1.M4V" type="video/mp4">
                    Ваш браузер не поддерживает видео.
                </video>
            </div>
            
            <!-- Слайды 2-3 -->
            <div class="slide-item">
                <img src="Images/img2.png" alt="Слайд 2">
            </div>
            <div class="slide-item">
                <img src="Images/img3.png" alt="Слайд 3">
            </div>
            
            <!-- Изба3.MP4 (после 3 слайда) -->
            <div class="video-item">
                <video controls preload="metadata" playsinline muted>
                    <source src="Изба3.MP4" type="video/mp4">
                    Ваш браузер не поддерживает видео.
                </video>
            </div>
            
            <!-- Слайды 4-5 -->
            <div class="slide-item">
                <img src="Images/img4.png" alt="Слайд 4">
            </div>
            <div class="slide-item">
                <img src="Images/img5.png" alt="Слайд 5">
            </div>
            
            <!-- Егор5.MP4 (после 5 слайда) -->
            <div class="video-item">
                <video controls preload="metadata" playsinline muted>
                    <source src="Егор5.MP4" type="video/mp4">
                    Ваш браузер не поддерживает видео.
                </video>
            </div>
            
            <!-- Слайды 6-7 -->
            <div class="slide-item">
                <img src="Images/img6.png" alt="Слайд 6">
            </div>
            <div class="slide-item">
                <img src="Images/img7.png" alt="Слайд 7">
            </div>
            
            <!-- Патрики7.MOV (после 7 слайда) -->
            <div class="video-item">
                <video controls preload="metadata" playsinline muted>
                    <source src="Патрики7.MOV" type="video/mp4">
                    Ваш браузер не поддерживает видео.
                </video>
            </div>
            
            <!-- Слайды 8-11 -->
            <div class="slide-item">
                <img src="Images/img8.png" alt="Слайд 8">
            </div>
            <div class="slide-item">
                <img src="Images/img9.png" alt="Слайд 9">
            </div>
            <div class="slide-item">
                <img src="Images/img10.png" alt="Слайд 10">
            </div>
            <div class="slide-item">
                <img src="Images/img11.png" alt="Слайд 11">
            </div>
            
            <!-- Раздел с отзывами -->
            <div class="reviews-section">
                <h2 class="reviews-title">НАШИ ОТЗЫВЫ</h2>
                <div class="videos-container">
                    <div class="video-wrapper">
                        <video controls preload="metadata" playsinline muted>
                            <source src="Video1.MOV" type="video/mp4">
                            Ваш браузер не поддерживает видео.
                        </video>
                    </div>
                    <div class="video-wrapper">
                        <video controls preload="metadata" playsinline muted>
                            <source src="Video2.MP4" type="video/mp4">
                            Ваш браузер не поддерживает видео.
                        </video>
                    </div>
                    <div class="video-wrapper">
                        <video controls preload="metadata" playsinline muted>
                            <source src="Video3.MP4" type="video/mp4">
                            Ваш браузер не поддерживает видео.
                        </video>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Кнопка внизу как ШАПКА -->
    <div class="bottom-button">
        <div class="button-container">
            <button class="main-button" onclick="contactMe()">
                <span class="button-text">Купить билет</span>
            </button>
        </div>
    </div>

    <script>
        function contactMe() {
            alert('Спасибо за интерес! Свяжитесь со мной по телефону или email.');
        }

        // Анимация и автозапуск
        document.addEventListener('DOMContentLoaded', function() {
            const slidesContainer = document.getElementById('slidesContainer');
            const items = document.querySelectorAll('.slide-item, .video-item, .video-wrapper');
            const videos = document.querySelectorAll('video');
            
            // Инициализация состояния видео
            videos.forEach(video => {
                video.setAttribute('data-current-time', '0');
            });
            
            function checkVisibility() {
                const containerRect = slidesContainer.getBoundingClientRect();
                const scrollTop = slidesContainer.scrollTop;
                const containerHeight = slidesContainer.clientHeight;
                
                // Анимация элементов
                items.forEach(item => {
                    const itemRect = item.getBoundingClientRect();
                    const itemTop = itemRect.top - containerRect.top + scrollTop;
                    const itemBottom = itemTop + item.offsetHeight;
                    const itemHeight = item.offsetHeight;
                    
                    // Проверяем, находится ли элемент в зоне видимости
                    const isVisible = (
                        itemTop < scrollTop + containerHeight &&
                        itemBottom > scrollTop
                    );
                    
                    if (isVisible) {
                        // Рассчитываем прогресс видимости (0-1)
                        const visibleTop = Math.max(itemTop, scrollTop);
                        const visibleBottom = Math.min(itemBottom, scrollTop + containerHeight);
                        const visibleHeight = visibleBottom - visibleTop;
                        const progress = Math.min(1, visibleHeight / itemHeight);
                        
                        // Применяем анимацию
                        item.style.opacity = progress;
                        item.style.transform = `translateY(${(1 - progress) * 30}px)`;
                        
                        // Если элемент полностью виден - добавляем класс
                        if (progress >= 0.9) {
                            item.classList.add('fully-visible');
                        }
                    } else {
                        item.style.opacity = '0';
                        item.style.transform = 'translateY(30px)';
                        item.classList.remove('fully-visible');
                    }
                });
                
                // Автозапуск видео
                videos.forEach(video => {
                    const videoRect = video.getBoundingClientRect();
                    const videoTop = videoRect.top - containerRect.top + scrollTop;
                    const videoBottom = videoTop + video.offsetHeight;
                    
                    // Если видео полностью в зоне видимости
                    if (videoTop >= scrollTop && videoBottom <= scrollTop + containerHeight) {
                        if (video.paused && video.muted) {
                            // Восстанавливаем позицию воспроизведения
                            const savedTime = video.getAttribute('data-current-time') || '0';
                            video.currentTime = parseFloat(savedTime);
                            
                            video.play().catch(e => {
                                console.log('Автоплей заблокирован:', e);
                            });
                        }
                    } else {
                        // Сохраняем позицию и останавливаем видео
                        if (!video.paused) {
                            video.setAttribute('data-current-time', video.currentTime.toString());
                            video.pause();
                        }
                    }
                });
            }
            
            slidesContainer.addEventListener('scroll', checkVisibility);
            setTimeout(checkVisibility, 100);
        });
    </script>
</body>
</html>
